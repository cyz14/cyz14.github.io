"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[584],{52650:function(L,x,t){t.r(x),t.d(x,{default:function(){return U}});var g=t(48305),p=t.n(g),m=t(75271),A={title:"title___W6A1v"},j=t(46966),y=t(16714),i=t(75398),u=t(85563),h=t(41160),E=t(18416),W=t(27713),l=t(52676),R=i.Z.TextArea;function U(){var F=(0,m.useState)(""),P=p()(F,2),B=P[0],K=P[1],N=(0,m.useState)([]),M=p()(N,2),Z=M[0],z=M[1],G=(0,m.useState)([]),b=p()(G,2),I=b[0],J=b[1],Q=function(o){K(o.target.value)},V=function(){var o=new DOMParser,T=o.parseFromString(B,"text/html"),O=T.querySelectorAll('.relative.row[style*="grid-column"]'),D=0,c=0;O.forEach(function(s){var v=s.getAttribute("style"),d=/grid-column:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?;\s*grid-row:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?/,r=v.match(d);if(r){var a=parseInt(r[1],10),n=r[2]?parseInt(r[2],10):1,C=parseInt(r[3],10),f=r[4]?parseInt(r[4],10):1;c=Math.max(c,a+n-1),D=Math.max(D,C+f-1)}}),c+=1;var H=Array.from({length:c},function(s,v){return v.toString()}),e=Array.from({length:D},function(){return Array(c).fill("")});O.forEach(function(s){var v=s.getAttribute("style"),d=/grid-column:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?;\s*grid-row:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?/,r=v.match(d);if(r){for(var a=parseInt(r[1],10),n=parseInt(r[3],10);e.length<=n;)e.push([]);for(;e[n].length<=a;)e[n].push("");var C=s.querySelector(".statistics-report__stat.assigned-popup .stat-cell");if(C){var f=C.querySelectorAll("span");if(f.length==2){var $=f[0].textContent.trim(),w=f[1].textContent.trim();e[n][a]==""&&(e[n][a]=$),e[n][a+1]==""&&(e[n][a+1]=w)}else{var q=f[0].textContent.trim();e[n][a]==""&&(e[n][a]=q)}}else{var k=s.querySelector(".row.assigned-popup span");if(k){var _=k.textContent.trim();e[n][a]==""&&(e[n][a]=_)}}}});var Y=H.map(function(s){return{title:s,dataIndex:s,key:s}});J(Y),z(e.map(function(s,v){return s.reduce(function(d,r,a){return d[H[a]]=r,d},{key:v.toString()})}))};function X(){var S=new E.Workbook,o=S.addWorksheet("Sheet 1");o.properties.defaultColWidth=5,console.log(I),o.columns=(0,W.WB)(I);var T=Z;o.addRows(T),(0,W.Cl)(S,"simple.xlsx")}return(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:A.title,children:"Page index"}),(0,l.jsx)(R,{rows:4,value:B,onChange:Q}),(0,l.jsx)("br",{}),(0,l.jsx)(u.Z,{}),(0,l.jsxs)(j.Z,{gap:"small",wrap:!0,children:[(0,l.jsx)(y.ZP,{type:"primary",onClick:V,children:"\u89E3\u6790"}),(0,l.jsx)(y.ZP,{type:"primary",onClick:X,children:"\u4FDD\u5B58\u4E3Aexcel"})]}),(0,l.jsx)(u.Z,{}),(0,l.jsx)(h.Z,{columns:I,dataSource:Z,pagination:!1,scroll:!0,size:"small",bordered:!0})]})}},27713:function(L,x,t){t.d(x,{Cl:function(){return A},WB:function(){return y},fy:function(){return m}});var g=t(11227),p=t.n(g);function m(i){return i.trim()}function A(i,u){i.xlsx.writeBuffer().then(function(h){var E=new Blob([h],{type:""});(0,g.saveAs)(E,u)})}var j=5;function y(i){return i==null?void 0:i.map(function(u){var h={header:u.title,key:u.dataIndex,width:u.width/5||j};return h})}}}]);
