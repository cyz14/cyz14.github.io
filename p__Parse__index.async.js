"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[584],{52650:function(J,E,s){s.r(E),s.d(E,{default:function(){return X}});var j=s(48305),T=s.n(j),S=s(75271),B={},H=s(46966),C=s(16714),f=s(75398),p=s(85563),A=s(41160),k=s(18416),R=s(27713),v=s(52676),Q=f.Z.TextArea;function X(){var Y=(0,S.useState)(""),F=T()(Y,2),O=F[0],$=F[1],q=(0,S.useState)([]),L=T()(q,2),U=L[0],N=L[1],w=(0,S.useState)([]),K=T()(w,2),Z=K[0],V=K[1],_=function(m){$(m.target.value)},tt=function(){var m=new DOMParser,x=m.parseFromString(O,"text/html"),b=x.querySelectorAll('.relative.row[style*="grid-column"]'),y=0,d=0;b.forEach(function(o){var h=o.getAttribute("style"),l=/grid-column:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?;\s*grid-row:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?/,e=h.match(l);if(e){var n=parseInt(e[1],10),r=e[2]?parseInt(e[2],10):1,t=parseInt(e[3],10),a=e[4]?parseInt(e[4],10):1;d=Math.max(d,n+r-1),y=Math.max(y,t+a-1)}}),d+=1;var c=Array.from({length:d},function(o,h){return h.toString()}),i=Array.from({length:y},function(){return Array(d).fill("")});b.forEach(function(o){var h=o.getAttribute("style"),l=/grid-column:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?;\s*grid-row:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?/,e=h.match(l);if(e){for(var n=parseInt(e[1],10),r=parseInt(e[3],10);i.length<=r;)i.push([]);for(;i[r].length<=n;)i[r].push("");var t=o.querySelector(".statistics-report__stat.assigned-popup .stat-cell");if(t){var a=t.querySelectorAll("span");if(a.length==2){var D=a[0].textContent.trim(),P=a[1].textContent.trim();i[r][n]==""&&(i[r][n]=D),i[r][n+1]==""&&(i[r][n+1]=P)}else{var M=a[0].textContent.trim();i[r][n]==""&&(i[r][n]=M)}}else{var g=o.querySelector(".row.assigned-popup span");if(g){var W=g.textContent.trim();i[r][n]==""&&(i[r][n]=W)}}}});var u=c.map(function(o){return{title:o,dataIndex:o,key:o}});V(u),N(i.map(function(o,h){return o.reduce(function(l,e,n){return l[c[n]]=e,l},{key:h.toString()})}))},et=function(){var m=new DOMParser,x=m.parseFromString(O,"text/html"),b=x.querySelector(".statistic-table");if(!b){console.error("table not found");return}var y=b.style,d=y.getPropertyValue("--row-count").trim(),c=y.getPropertyValue("--column-count").trim();console.log("Row",d,"Col",c),d=parseInt(d,10),c=parseInt(c,10),c+=1;var i=Array.from({length:c},function(l,e){return e.toString()}),u=Array.from({length:d},function(){return Array(c).fill("")}),o=x.querySelectorAll(".statistic-table-cell");o.forEach(function(l){var e=l.getAttribute("style"),n=/grid-row:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?;\s*grid-column:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?/,r=e.match(n);if(r){for(var t=parseInt(r[1],10),a=parseInt(r[3],10);u.length<=t;)u.push([]);for(;u[t].length<=a;)u[t].push("");var D=l.querySelector(".text-cell-content");if(D){var P=D.textContent.trim();u[t][a]==""&&(u[t][a]=P),console.log(t,a,P)}else{var M=l.querySelector(".stat-cell");if(M){var g=M.querySelectorAll("span");if(g.length==2){var W=g[0].textContent.trim(),z=g[1].textContent.trim();u[t][a]==""&&(u[t][a]=W),u[t][a+1]==""&&(u[t][a+1]=z),console.log(t,a,W,z)}else{var G=g[0].textContent.trim();u[t][a]==""&&(u[t][a]=G),console.log(t,a,G)}}}}});var h=i.map(function(l){return{title:l,dataIndex:l,key:l}});V(h),N(u.map(function(l,e){return l.reduce(function(n,r,t){return n[i[t]]=r,n},{key:e.toString()})}))};function rt(){var I=new k.Workbook,m=I.addWorksheet("Sheet 1");m.properties.defaultColWidth=5,console.log(Z),m.columns=(0,R.WB)(Z);var x=U;m.addRows(x),(0,R.Cl)(I,"simple.xlsx")}return(0,v.jsxs)("div",{children:[(0,v.jsx)("h1",{className:B.title,children:"Hand2Note4 popup parser"}),(0,v.jsx)(Q,{rows:4,value:O,onChange:_,placeholder:"div.popup-stat-table \u6216 div.statistic-table"}),(0,v.jsx)("br",{}),(0,v.jsx)("br",{}),(0,v.jsxs)(H.Z,{gap:"small",wrap:!0,children:[(0,v.jsx)(C.ZP,{type:"primary",onClick:tt,children:"\u89E3\u67904.0.0"}),(0,v.jsx)(C.ZP,{type:"primary",onClick:et,children:"\u89E3\u67904.0.1"}),(0,v.jsx)(C.ZP,{type:"primary",onClick:rt,children:"\u4FDD\u5B58\u4E3Aexcel"})]}),(0,v.jsx)(p.Z,{}),(0,v.jsx)(A.Z,{columns:Z,dataSource:U,pagination:!1,scroll:!0,size:"small",bordered:!0})]})}},27713:function(J,E,s){s.d(E,{Cl:function(){return B},WB:function(){return C},fy:function(){return S}});var j=s(11227),T=s.n(j);function S(f){return f.trim()}function B(f,p){f.xlsx.writeBuffer().then(function(A){var k=new Blob([A],{type:""});(0,j.saveAs)(k,p)})}var H=5;function C(f){return f==null?void 0:f.map(function(p){var A={header:p.title,key:p.dataIndex,width:p.width/5||H};return A})}}}]);
