"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[584],{52650:function(J,j,s){s.r(j),s.d(j,{default:function(){return X}});var b=s(48305),T=s.n(b),S=s(75271),B={title:"title___W6A1v"},H=s(46966),A=s(16714),d=s(75398),g=s(85563),C=s(41160),Z=s(18416),R=s(27713),v=s(52676),Q=d.Z.TextArea;function X(){var Y=(0,S.useState)(""),F=T()(Y,2),k=F[0],$=F[1],q=(0,S.useState)([]),L=T()(q,2),U=L[0],N=L[1],w=(0,S.useState)([]),K=T()(w,2),O=K[0],V=K[1],_=function(m){$(m.target.value)},tt=function(){var m=new DOMParser,x=m.parseFromString(k,"text/html"),E=x.querySelectorAll('.relative.row[style*="grid-column"]'),y=0,f=0;E.forEach(function(o){var h=o.getAttribute("style"),l=/grid-column:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?;\s*grid-row:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?/,e=h.match(l);if(e){var n=parseInt(e[1],10),r=e[2]?parseInt(e[2],10):1,t=parseInt(e[3],10),a=e[4]?parseInt(e[4],10):1;f=Math.max(f,n+r-1),y=Math.max(y,t+a-1)}}),f+=1;var c=Array.from({length:f},function(o,h){return h.toString()}),i=Array.from({length:y},function(){return Array(f).fill("")});E.forEach(function(o){var h=o.getAttribute("style"),l=/grid-column:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?;\s*grid-row:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?/,e=h.match(l);if(e){for(var n=parseInt(e[1],10),r=parseInt(e[3],10);i.length<=r;)i.push([]);for(;i[r].length<=n;)i[r].push("");var t=o.querySelector(".statistics-report__stat.assigned-popup .stat-cell");if(t){var a=t.querySelectorAll("span");if(a.length==2){var D=a[0].textContent.trim(),P=a[1].textContent.trim();i[r][n]==""&&(i[r][n]=D),i[r][n+1]==""&&(i[r][n+1]=P)}else{var W=a[0].textContent.trim();i[r][n]==""&&(i[r][n]=W)}}else{var p=o.querySelector(".row.assigned-popup span");if(p){var M=p.textContent.trim();i[r][n]==""&&(i[r][n]=M)}}}});var u=c.map(function(o){return{title:o,dataIndex:o,key:o}});V(u),N(i.map(function(o,h){return o.reduce(function(l,e,n){return l[c[n]]=e,l},{key:h.toString()})}))},et=function(){var m=new DOMParser,x=m.parseFromString(k,"text/html"),E=x.querySelector(".statistic-table");if(!E){console.error("table not found");return}var y=E.style,f=y.getPropertyValue("--row-count").trim(),c=y.getPropertyValue("--column-count").trim();console.log("Row",f,"Col",c),f=parseInt(f,10),c=parseInt(c,10),c+=1;var i=Array.from({length:c},function(l,e){return e.toString()}),u=Array.from({length:f},function(){return Array(c).fill("")}),o=x.querySelectorAll(".statistic-table-cell");o.forEach(function(l){var e=l.getAttribute("style"),n=/grid-row:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?;\s*grid-column:\s*(\d+)(?:\s*\/\s*span\s*(\d+))?/,r=e.match(n);if(r){for(var t=parseInt(r[1],10),a=parseInt(r[3],10);u.length<=t;)u.push([]);for(;u[t].length<=a;)u[t].push("");var D=l.querySelector(".text-cell-content");if(D){var P=D.textContent.trim();u[t][a]==""&&(u[t][a]=P),console.log(t,a,P)}else{var W=l.querySelector(".stat-cell");if(W){var p=W.querySelectorAll("span");if(p.length==2){var M=p[0].textContent.trim(),z=p[1].textContent.trim();u[t][a]==""&&(u[t][a]=M),u[t][a+1]==""&&(u[t][a+1]=z),console.log(t,a,M,z)}else{var G=p[0].textContent.trim();u[t][a]==""&&(u[t][a]=G),console.log(t,a,G)}}}}});var h=i.map(function(l){return{title:l,dataIndex:l,key:l}});V(h),N(u.map(function(l,e){return l.reduce(function(n,r,t){return n[i[t]]=r,n},{key:e.toString()})}))};function rt(){var I=new Z.Workbook,m=I.addWorksheet("Sheet 1");m.properties.defaultColWidth=5,console.log(O),m.columns=(0,R.WB)(O);var x=U;m.addRows(x),(0,R.Cl)(I,"simple.xlsx")}return(0,v.jsxs)("div",{children:[(0,v.jsx)("h1",{className:B.title,children:"Hand2Note4 popup parser"}),(0,v.jsx)(Q,{rows:4,value:k,onChange:_}),(0,v.jsx)("br",{}),(0,v.jsx)(g.Z,{}),(0,v.jsxs)(H.Z,{gap:"small",wrap:!0,children:[(0,v.jsx)(A.ZP,{type:"primary",onClick:tt,children:"\u89E3\u67904.0.0"}),(0,v.jsx)(A.ZP,{type:"primary",onClick:et,children:"\u89E3\u67904.0.1"}),(0,v.jsx)(A.ZP,{type:"primary",onClick:rt,children:"\u4FDD\u5B58\u4E3Aexcel"})]}),(0,v.jsx)(g.Z,{}),(0,v.jsx)(C.Z,{columns:O,dataSource:U,pagination:!1,scroll:!0,size:"small",bordered:!0})]})}},27713:function(J,j,s){s.d(j,{Cl:function(){return B},WB:function(){return A},fy:function(){return S}});var b=s(11227),T=s.n(b);function S(d){return d.trim()}function B(d,g){d.xlsx.writeBuffer().then(function(C){var Z=new Blob([C],{type:""});(0,b.saveAs)(Z,g)})}var H=5;function A(d){return d==null?void 0:d.map(function(g){var C={header:g.title,key:g.dataIndex,width:g.width/5||H};return C})}}}]);
